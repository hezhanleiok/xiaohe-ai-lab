---
import BaseLayout from "../../layouts/BaseLayout.astro";

/**
 * 使用 import.meta.glob（Astro v4 最稳写法）
 */
export async function getStaticPaths() {
  const modules = import.meta.glob("../../content/blog/*.md");

  return Object.keys(modules).map((path) => {
    const slug = path.split("/").pop().replace(".md", "");
    return {
      params: { slug },
      props: { path },
    };
  });
}

const { path } = Astro.props;
const post = await import(path);
const { Content, frontmatter } = post;
---

<BaseLayout title={frontmatter.title}>
  <article>
    <h1>{frontmatter.title}</h1>
    {frontmatter.description && (
      <p style="color:#666">{frontmatter.description}</p>
    )}
    <Content />
  </article>
</BaseLayout>
